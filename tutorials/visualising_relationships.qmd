---
title: "Visualising relationships"
---

In this tutorial we will continue to learn about visualisation as a tool for exploratory data analysis.
We will look at ways of visualising the <mark>relationship</mark> between two or more variables using bar and column plots, scatterplots, additional aesthetics and <mark>facets</mark>.

## Objectives

By the end of this tutorial you should:

* Be able to generate questions about the relationship between two or more variables
* Know how to produce bar plots, multiple density plots, stacked bar plots, and scatter plots in R using ggplot2
* Be able to refine plots for communication and export them from R

## Prerequisites

* Edward Tufte, *[The Visual Display Of Quantitative Information](https://archive.org/details/the-visual-display-of-quantitative-information-2ed-by-tufte-edward-r.-z-lib.org)* (2nd edition), pp. 91–138:
  * Chapter 4, "Data–Ink and Graphical Redesign"
  * Chapter 5, "Chartjunk: Vibrations, Grids, and Ducks"
  * Chapter 6, "Data–Ink Maximization and Graphical Design"

## Generating questions about relationships

Last week we looked at using visualisation to answer questions about the variation of a variable (its <mark>distribution</mark>).
Although essential for describing and understanding the nature of your dataset, questions about a single variable have a fundamentally limited explanatory value.

This week we will start looking at the <mark>covariation</mark> between two (or more) variables – in plain terms, the relationship between them.
With this we can start to gain insights into <mark>causality</mark>.
In statistics, we say that there is a <mark>correlation</mark> between two variables if one can measurably <mark>predict</mark> the other.
This is *not* a statement about causality, merely practicality: if you knew two variables were correlated, you could make a good guess about the value of the other.

This leads to the well-known adage, <mark>"correlation is not causation"</mark>.
But equally, we should be aware that correlation can be a good hint about causation!

### Exercises

Given a dataset on a burial ground, with the following variables:

* sex of the individual
* age of the individual
* age of the burial (i.e. a radiocarbon date)
* number of grave goods
* number of metal objects amongst the grave goods

1. What questions of covariation could we ask of the dataset?
2. If there was a correlation between the age of the individual and the number of grave goods, could that imply causation?
3. What about a correlation between the number of grave goods and the number of metal objects?

## Visualising relationships

Work through [section 2.5 and 2.6](https://r4ds.hadley.nz/data-visualize.html#visualizing-relationships) of *R for Data Science" (2nd ed.)

You will then apply these techniques to an archaeological dataset.

## Lithic assemblages from Islay

Load the `islay_lithics` dataset from islay:

```{r}
library(islay)
data(islay_lithics)
```

We can use the `head()` function to get a quick preview of the data frame:

```{r}
head(islay_lithics)
```

Because this is an in-built dataset of the package, you can also enter `?islay_lithics` to open the help page for the dataset, which contains more information on what it describes.

As with the last dataset, it will be useful to turn the `period` column into a <mark>factor</mark> now, so that it will automatically be ordered in our subsequent plots:

```{r}
periods <- c("Mesolithic", "Mesolithic & Later Prehistoric", "Later Prehistoric")
islay_lithics$period <- factor(islay_lithics$period, periods)
```

### Exercises

1. Generate a plot showing the relationship between period and the number of retouched pieces. Is there a correlation? What could explain this?
2. Try with two other types of lithics. Does it change your answer?
3. Generate a plot showing the relationship between the number of two types of lithics.
4. Add an <mark>aesthetic</mark> showing a categorical variable.
5. Export the plot.

